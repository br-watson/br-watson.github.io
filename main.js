function O(e){let o=new Map;return e.links.github&&o.set("github",e.links.github),e.links.linkedin&&o.set("linkedin",e.links.linkedin),e.filePaths.cv&&o.set("cv",e.filePaths.cv),e.filePaths.dissertation&&o.set("dissertation",e.filePaths.dissertation),e.email&&o.set("email",`mailto:${e.email}`),o}function V({profile:e}){let o=new Map,l=(t,m,s,n,a)=>{o.set(t,{name:t,summary:m,usage:s,execute:n,complete:a})};return l("help","Show this help","help",t=>{let{s:m}=t.seg;t.printLine([m("accent","Available commands")],"ok");let s=Array.from(o.values()).sort((a,p)=>a.name.localeCompare(p.name)).map(a=>`${a.name.padEnd(12," ")} ${a.summary.padEnd(32," ")} ${a.usage}`),n=[`${"COMMAND".padEnd(12," ")} ${"SUMMARY".padEnd(32," ")} USAGE`,"",...s,"","Tips: use \u2191/\u2193 for history, Tab for autocomplete (Shift+Tab to move focus)."];t.printPre(n.join(`
`),"ok")}),l("clear","Clear the screen","clear",t=>t.clear()),l("whoami","About me","whoami",t=>{t.printLine(`${String(e.name)} \u2014 ${String(e.role)} (${String(e.location)})`)}),l("date","Print local date/time","date",t=>{t.printLine(new Date().toString(),"muted")}),l("echo","Print args","echo <text>",(t,m)=>{t.printLine(m.join(" "))}),l("ls","List files (only ~ supported)","ls [path]",(t,m)=>{if((m[0]??"~")!=="~"){t.printLine('ls: only "~" is supported in this tiny filesystem',"error");return}t.printPre(t.listHome().join(`
`),"ok")}),l("cat","Print file contents","cat <file>",(t,m)=>{let{t:s,l:n,s:a}=t.seg,p=m[0];if(!p){t.printLine("cat: missing file operand","error");return}let g=t.resolveHomeItem(p);if(!g){t.printLine(`cat: ${p}: No such file`,"error");return}switch(g.type){case"file":{t.printPre(String(g.content),"ok");break}case"link":{t.printLine([s(`${p} -> `),n(g.href),s(" (click me! or run "),a("accent",`open ${p}`),s(")")],"muted");break}case"links":{let k=(d,b)=>" ".repeat(Math.max(0,b-d.length)),i=Object.entries(g.items).flatMap(([d,b])=>[s(`${d}: `.padEnd(10," ")),n(b,d),s(k(d,8)),s(" (or run "),a("accent",`open ${d}`),s(`)
`)]);t.printLine(i,"muted wrap-desktop");break}case"projects":{let k=g.projects.flatMap(i=>[a("accent",`${i.name}
`),s(`${i.desc}
`),...i.repoLink?[n(i.repoLink),s(`
`)]:[s("")],...i.deployedLink?[n(i.deployedLink),s(`
`)]:[s("")],i.tags&&i.tags.length>0?s(`Tech stack: ${i.tags.join(", ")}
`):s(""),s(`
`)]);t.printLine(k,"muted wrap-desktop");break}case"education":{let k=g.education.flatMap(i=>[a("accent",`${i.qualification} - ${i.institution}
`),s(`${i.location} | ${i.startDate} - ${i.endDate} | ${i.grade}
`),i.description?s(`${i.description}
`):s(""),...i.dissertation?[s("Dissertation: "),n(i.dissertation.link,i.dissertation.title),s(`
`)]:[s("")],i.tags&&i.tags.length>0?s(`Tags: ${i.tags.join(", ")}
`):s(""),s(`
`)]);t.printLine(k,"muted wrap-desktop");break}default:{t.printLine(`cat: ${p}: Not a file`,"error");break}}},(t,m)=>{if(m.argIndex!==0)return[];let s=t.listHome().filter(a=>t.resolveHomeItem(a)?.type==="file"||t.resolveHomeItem(a)?.type==="link"||t.resolveHomeItem(a)?.type==="links"||t.resolveHomeItem(a)?.type==="projects"||t.resolveHomeItem(a)?.type==="education"),n=(m.prefix??"").toLowerCase();return s.filter(a=>String(a).toLowerCase().startsWith(n)).sort()}),l("open","Open link","open <alias>",(t,m)=>{let{t:s,l:n}=t.seg,a=m[0],p=(a??"").toLowerCase();if(!p){t.printLine("open: missing target (press Tab to see valid options)","error");return}let g=O(t.profile);if(g.has(p)){let k=g.get(p);k&&(t.printLine([s("Opening: "),n(k)],"muted"),t.openUrl(k));return}t.printLine(`open: unknown target "${a}"`,"error")},(t,m)=>{if(m.argIndex!==0)return[];let n=[...O(t.profile).keys()],a=(m.prefix??"").toLowerCase();return Array.from(new Set(n)).filter(p=>String(p).toLowerCase().startsWith(a)).sort()}),l("bio","Alias: cat bio.txt","bio",t=>o.get("cat")?.execute(t,["bio.txt"])),l("projects","Alias: cat projects.txt","projects",t=>o.get("cat")?.execute(t,["projects.txt"])),l("socials","Alias: cat socials.txt","socials",t=>o.get("cat")?.execute(t,["socials.txt"])),l("cv","Alias: open cv","cv",t=>o.get("open")?.execute(t,["cv"])),l("skills","List my skills","skills",t=>o.get("cat")?.execute(t,["skills.txt"])),l("education","List my education","education",t=>o.get("cat")?.execute(t,["education.txt"])),l("roles","List my roles and experience","roles",t=>o.get("cat")?.execute(t,["roles.txt"])),l("theme","Switch theme","theme [dark|light|toggle]",(t,m)=>{let s=(m[0]??"").toLowerCase(),n=t.theme.get();if(!s){t.printLine(`theme: current is "${n}"`,"muted"),t.printLine("Try: theme dark | theme light | theme toggle","muted");return}if(s==="toggle"){t.theme.toggle(),t.printLine(`theme: set to "${t.theme.get()}"`,"muted");return}if(s!=="dark"&&s!=="light"){t.printLine('theme: expected "dark" or "light"',"error");return}t.theme.set(s),t.printLine(`theme: set to "${s}"`,"muted")},(t,m)=>{if(m.argIndex!==0)return[];let s=["dark","light","toggle"],n=(m.prefix??"").toLowerCase();return Array.from(new Set(s)).filter(a=>String(a).toLowerCase().startsWith(n)).sort()}),{commands:o}}function z(e){return{"~":{type:"dir",children:{"README.txt":{type:"file",content:["Welcome.","","Try: help, ls, cat README.txt, bio, projects, socials, open cv, open github"].join(`
`)},"bio.txt":{type:"file",content:e.bio.join(`
`)},"projects.txt":{type:"projects",projects:e.projects},"socials.txt":{type:"links",items:e.links},"skills.txt":{type:"file",content:e.skills.join(", ")},"education.txt":{type:"education",education:e.education},"roles.txt":{type:"file",content:e.roles.map(o=>{let l=o.title??"Untitled Role",t=o.company?` at ${o.company}`:"",m=o.location?` in ${o.location}`:"",s=` (${o.startDate} - ${o.endDate??"Present"})`,n=o.description?`
  ${o.description}`:"";return`- ${l}${t}${m}${s}${n}`}).join(`

`)},"cv.pdf":{type:"link",href:e.filePaths.cv},"dissertation.pdf":{type:"link",href:e.filePaths.dissertation},"todo.md":{type:"file",content:e.todo.map(o=>`- [ ] ${o}`).join(`
`)}}}}}function G(e){let o=e["~"];if(!o||o.type!=="dir")throw new Error("Invalid filesystem: missing home dir");return o}function Y(e){return Object.keys(G(e).children).sort()}function J(e,o){return G(e).children[o]}var M=e=>({type:"text",text:e}),L=(e,o)=>({type:"span",className:e,text:o}),Te=(e,o)=>({type:"link",href:e,text:o});function X({renderer:e,profile:o,fs:l,commands:t,openUrl:m,theme:s}){let n={history:[],historyIndex:-1,completion:null,hasRunCommand:!1,hasBooted:!1};function a(){n.hasBooted=!0,p()}function p(){e.clear(),b(),C([M("Type "),L("accent","help"),M(" to see commands.")],"muted"),e.scrollToBottom()}function g(){!n.hasBooted||n.hasRunCommand||p()}function k(r){return r.reduce((u,c)=>Math.max(u,c.length),0)}function i(r,u){return r.length<=u?r:u<=1?"\u2026":`${r.slice(0,u-1)}\u2026`}function d(r,u){let c=i(r,u),f=Math.max(0,u-c.length),h=Math.floor(f/2),x=f-h;return{leftPad:" ".repeat(h),text:c,rightPad:" ".repeat(x)}}function b(){let r=o.nameAsciiArt??[],u=k(r),c=e.getColumns();if(r.length>0&&u<=c){_(r.join(`
`),"accent"),C(o.role,"muted");return}T()}function T(){let r=String(o.name).trim()||"Portfolio",u=String(o.role).trim()||"Software Engineer",c=e.getColumns(),f=P(c-6,10,54),h=Math.min(20,f),x=Math.max(r.length,u.length,h-4),y=P(x+4,h,f),S=`\u256D${"\u2500".repeat(y+2)}\u256E`,v=`\u251C${"\u2500".repeat(y+2)}\u2524`,A=`\u2570${"\u2500".repeat(y+2)}\u256F`,$=(w,I=!0)=>{let E=d(w,y);return[L("banner-border","\u2502 "),L("banner-border",E.leftPad),L("banner-text",E.text),L("banner-border",E.rightPad),L("banner-border",I?` \u2502
`:" \u2502")]},N=[L("banner-border",`${S}
`),...$(r),L("banner-border",`${v}
`),...$(u),L("banner-border",A)];C(N,"banner")}function P(r,u,c){return Math.max(u,Math.min(c,r))}function C(r,u="ok"){let c=Array.isArray(r)?r:[M(String(r))];e.printLine(c,u)}function _(r,u="ok"){e.printPre(String(r),u)}function H(r){C([L("cmd","$"),M(" "),L("cmd",r)],"cmd")}function j(){return Y(l)}function ge(r){return J(l,r)}function q(){return{profile:o,fs:l,theme:s,openUrl:m,printLine:C,printPre:_,seg:{t:M,s:L,l:Te},listHome:j,resolveHomeItem:ge,clear:e.clear}}async function he(r){let u=r.trim();if(!u)return;n.hasRunCommand=!0,H(u);let c=K(u),[f,...h]=c.tokens,x=t.get(f);if(!x){C([M("Command not found: "),L("error",f)],"error"),C([M("Try: "),L("accent","help")],"muted");return}try{await x.execute(q(),h)}catch(y){let S=y instanceof Error?y.message:String(y);C([L("error","Error:"),M(" "),M(S)],"error")}}function K(r){let u=[],c="",f=null,h=!1;for(let x=0;x<r.length;x++){let y=r[x];if(h){c+=y,h=!1;continue}if(y==="\\"){h=!0;continue}if(f){if(y===f){f=null;continue}c+=y;continue}if(y==='"'||y==="'"){f=y;continue}if(/\s/.test(y)){c&&(u.push(c),c="");continue}c+=y}return h&&(c+="\\"),c&&u.push(c),{tokens:u,endsWithWhitespace:/\s$/.test(r),unterminatedQuote:f}}function ye(r){n.history.push(r),n.historyIndex=n.history.length}function ke(){return n.history.length===0?null:(n.historyIndex=Math.max(0,n.historyIndex-1),n.history[n.historyIndex]??"")}function be(){return n.history.length===0?null:(n.historyIndex=Math.min(n.history.length,n.historyIndex+1),n.history[n.historyIndex]??"")}function xe(r){let u=K(r);if(n.completion?.phase==="menu"){let w=n.completion,I=w.values.indexOf(r);if(I!==-1){let E=(I+1)%w.values.length;return w.index=E,w.lastValue=w.values[E],w.lastValue}n.completion=null}let{tokens:c,endsWithWhitespace:f}=u;if(c.length===0)return"";let h=Array.from(t.keys()).sort();if(c.length===1&&!f){let w=c[0],I=h.filter(E=>E.startsWith(w));return Q("cmd",r,w,I,E=>E)??r}let x=c[0],y=t.get(x);if(!y?.complete)return r;let S=c.slice(1),v=f?"":S[S.length-1]??"",A=f?S.length:Math.max(0,S.length-1),$={line:r,tokens:c,args:S,endsWithWhitespace:f,argIndex:A,prefix:v},N=y.complete(q(),$)||[];return Q(`arg:${x}`,r,v,N,w=>[...f?c:c.slice(0,-1),Le(w)].join(" "))??r}function Le(r){return/\s/.test(r)?`"${r.replace(/"/g,'\\"')}"`:r}function ve(r){if(r.length===0)return"";let u=r[0];for(let c=1;c<r.length;c++){let f=r[c],h=0;for(;h<u.length&&h<f.length&&u[h]===f[h];)h++;if(u=u.slice(0,h),u==="")break}return u}function we(r){return r.join("\0")}function Q(r,u,c,f,h){if(f.length===0)return n.completion=null,null;if(f.length===1)return n.completion=null,h(f[0]);let x=we(f),y=ve(f);if(y.length>c.length){let v=h(y);return n.completion={phase:"armed",kind:r,baseInput:v,prefix:y,matchesKey:x,values:f.map(h),index:-1,lastValue:null},v}if(!(n.completion&&n.completion.kind===r&&n.completion.baseInput===u&&n.completion.prefix===c&&n.completion.matchesKey===x))return n.completion={phase:"armed",kind:r,baseInput:u,prefix:c,matchesKey:x,values:f.map(h),index:-1,lastValue:null},null;if(n.completion?.phase==="armed"){let v=[];return f.forEach((A,$)=>{$&&v.push(M("   ")),v.push(L("accent",A))}),C(v,"muted wrap-desktop"),e.scrollToBottom(),n.completion.phase="listed",null}if(n.completion?.phase==="listed"){let v=n.completion?.values[0];return n.completion.phase="menu",n.completion.index=0,n.completion.lastValue=v,v}return null}return{boot:a,run:he,addHistory:ye,historyUp:ke,historyDown:be,autocomplete:xe,refreshIntroIfPristine:g}}var D={name:"Bradley Watson",nameAsciiArt:["____________  ___ ______   _    _  ___ _____ _____  _____ _   _","| ___ \\ ___ \\/ _ \\|  _  \\ | |  | |/ _ \\_   _/  ___||  _  | \\ | |","| |_/ / |_/ / /_\\ \\ | | | | |  | / /_\\ \\| | \\ `--. | | | |  \\| |","| ___ \\    /|  _  | | | | | |/\\| |  _  || |  `--. \\| | | | . ` |","| |_/ / |\\ \\| | | | |/ /  \\  /\\  / | | || | /\\__/ /\\ \\_/ / |\\  |","\\____/\\_| \\_\\_| |_/___/    \\/  \\/\\_| |_/\\_/ \\____/  \\___/\\_| \\_/"],role:"Software Engineer",location:"Leeds, UK",email:"you@example.com",links:{github:"https://github.com/br-watson",linkedin:"https://www.linkedin.com/in/bradleyrwatson"},filePaths:{cv:"./assets/cv.pdf",dissertation:"./assets/diss.pdf"},bio:["I build backend systems, pipelines, and cloud infrastructure.","Current interests: TODO...","This site is a small fake shell because normal portfolios are kinda boring."],projects:[{name:"Terminal Portfolio",desc:"This project! An interactive terminal-style portfolio built with TypeScript, HTML, and CSS.",repoLink:"https://github.com/br-watson/br-watson.github.io",deployedLink:"https://bwatson.uk",tags:["TypeScript","HTML","CSS"]},{name:"TODO...",desc:"Lorem ipsum dolor sit amet, consectetur adipiscing elit.",repoLink:"",tags:["TODO..."]}],skills:["TypeScript","AWS","TODO..."],education:[{qualification:"Master of Mathematics (MMath)",institution:"Durham University",location:"Durham, UK",startDate:"2018",endDate:"2022",grade:"1:1 (Honours)",description:"Specialised in mathematical analysis, geometry, and algebra. Dissertation on isometries of Riemannian manifolds.",tags:["Mathematical analysis","Geometry","Algebra","Calculus","Linear algebra","Partial differential equations"],dissertation:{title:"Isometries of Riemannian Manifolds",link:"./assets/diss.pdf"}},{qualification:"A-Levels",institution:"Notre Dame Sixth Form College",location:"Leeds, UK",startDate:"2016",endDate:"2018",grade:"A*AAA",tags:["Mathematics","Further Mathematics","Computer Science","Chemistry"]}],roles:[{title:"Software Engineer",company:"Sky UK",location:"Leeds, UK",startDate:"Sep 2024",description:"TODO..."},{title:"Associate Software Engineer",company:"Sky UK",location:"Leeds, UK",startDate:"Sep 2023",endDate:"Sep 2024",description:"TODO..."}],todo:["Finish writing profile (bio, experience, projects, skills etc.)","Add more commands","Improve txt files output formatting","Make actual CV","Add way for mobile to access command history and autocomplete","Write README","Make sure accessibility is good","Make sure performance is good","Add my actual email","Write tests"]};function Z(e){return function(l){let t=new Set(["https:","mailto:"]);try{let m=new URL(l,window.location.href);if(!t.has(m.protocol)&&m.origin!==window.location.origin){e.show("Blocked unsafe URL");return}}catch{e.show("Invalid URL");return}window.open(String(l),"_blank","noopener,noreferrer")}}function ee({form:e,input:o,terminal:l,renderer:t}){function m(){o.focus({preventScroll:!0})}function s(){requestAnimationFrame(()=>{o.selectionStart=o.selectionEnd=o.value.length})}return e.addEventListener("submit",async n=>{n.preventDefault();let a=o.value;o.value="",a.trim()&&(l.addHistory(a),await l.run(a)),t.scrollToBottom(),m()}),o.addEventListener("keydown",n=>{if(!(n.altKey||n.ctrlKey||n.metaKey)){if(n.key==="ArrowUp"){n.preventDefault();let a=l.historyUp();if(a===null)return;o.value=a,s()}if(n.key==="ArrowDown"){n.preventDefault();let a=l.historyDown();if(a===null)return;o.value=a,s()}if(n.key==="Tab"){if(n.shiftKey)return;n.preventDefault(),o.value=l.autocomplete(o.value),s()}}}),{focus:m}}var te="terminal-theme";function Ce(e){return e==="light"||e==="dark"}function ne(e){return e.toLowerCase()==="light"?"light":"dark"}function oe(e){return e.toLowerCase()==="light"?"dark":"light"}function ie({themeToggle:e,toast:o,storage:l=window.localStorage,doc:t=document,matchMedia:m=window.matchMedia?.bind(window)}){function s(){let d=l.getItem(te);return Ce(d)?d:null}function n(){return m?.("(prefers-color-scheme: light)")?.matches?"light":"dark"}let a=s()??n(),p=ne(a);function g(d,b={}){let{persist:T=!0,announce:P=!0,force:C=!1}=b,_=ne(d),H=_!==p;if(p=_,(H||C)&&(t.documentElement.dataset.theme=_,e)){let j=oe(_);e.setAttribute("aria-pressed",String(_==="light")),e.setAttribute("aria-label",`Switch to ${j.toLowerCase()} theme`),e.textContent=j}T&&l.setItem(te,_),P&&H&&o.show(`theme: ${_}`)}let k={get:()=>p,set:d=>g(d,{persist:!0,announce:!0}),toggle:()=>g(oe(p),{persist:!0,announce:!0})};e&&e.addEventListener("click",()=>k.toggle());function i(){g(a,{persist:!1,announce:!1,force:!0})}return{controller:k,applyInitialTheme:i}}function re(e,o=1500){let l;function t(m){e&&(e.textContent=m,e.classList.add("show"),e.setAttribute("aria-hidden","false"),l&&window.clearTimeout(l),l=window.setTimeout(()=>{e.classList.remove("show"),e.setAttribute("aria-hidden","true")},o))}return{show:t}}function se({screen:e}){function o(i,d){return i.split(/\s+/).includes(d)}function l(){let i=document.createElement("span");i.className="line ok",i.style.position="absolute",i.style.visibility="hidden",i.style.whiteSpace="pre",i.textContent="M",e.appendChild(i);let d=i.getBoundingClientRect().width;return e.removeChild(i),d||8}function t(){let i=l();return Math.max(1,Math.floor(e.clientWidth/i))}function m(i){let d=new Set(["https:","mailto:"]);try{let b=new URL(i,window.location.href);return d.has(b.protocol)?!0:b.origin===window.location.origin}catch{return!1}}function s(i){if(i.type==="text")return document.createTextNode(i.text);if(i.type==="span"){let d=document.createElement("span");return d.className=i.className,d.textContent=i.text,d}if(i.type==="link"){if(!m(i.href))return document.createTextNode(i.text??i.href);let d=document.createElement("a");return d.href=i.href,d.target="_blank",d.rel="noopener noreferrer",d.textContent=i.text??i.href,d}return document.createTextNode("")}function n(i){let d=document.createDocumentFragment();for(let b of i)d.appendChild(s(b));return d}function a(i,d="ok"){let b=document.createElement("div");b.className="block",o(d,"wrap-desktop")&&b.classList.add("wrap-desktop");let T=document.createElement("div");T.className=`line ${d}`,T.appendChild(n(i)),b.appendChild(T),e.appendChild(b)}function p(i,d="ok"){let b=document.createElement("div");b.className="block";let T=document.createElement("div");T.className=`line ${d}`;let P=document.createElement("pre");P.className="pre",P.textContent=i,T.appendChild(P),b.appendChild(T),e.appendChild(b)}function g(){for(;e.firstChild;)e.removeChild(e.firstChild)}function k(){e.scrollTop=e.scrollHeight}return{printLine:a,printPre:p,clear:g,scrollToBottom:k,getColumns:t}}function ae({container:e,list:o,profile:l,onRunCommand:t,aliases:m}){if(!(e instanceof HTMLElement)||!(o instanceof HTMLElement))return;let s=O(l),n=m.filter(a=>s.has(a)).map(a=>`open ${a}`);if(o.replaceChildren(),n.length===0){e.hidden=!0;return}for(let a of n){let p=document.createElement("button");p.type="button",p.className="quick-link",p.dataset.command=a,p.setAttribute("aria-label",`Run ${a}`),p.title=a;let g=document.createElement("span");g.className="quick-link-sigil",g.textContent="$";let k=document.createElement("span");k.textContent=a,p.append(g,k),o.appendChild(p)}o.addEventListener("click",async a=>{let p=a.target;if(!(p instanceof Element))return;let g=p.closest("button[data-command]");if(!(g instanceof HTMLButtonElement))return;let k=g.dataset.command?.trim();k&&(a.detail>0&&g.blur(),await t(k))}),e.hidden=!1}var de=document.getElementById("screen"),_e=document.getElementById("prompt"),U=document.getElementById("input"),Se=document.getElementById("themeToggle"),Ee=document.getElementById("toast"),le=document.querySelector(".title"),ce=document.querySelector(".ps1"),Me=document.getElementById("quickLinks"),Pe=document.getElementById("quickLinksList"),W=window.matchMedia("(pointer: coarse)").matches,ue="brad@portfolio";le&&(le.textContent=`${ue}: ~`);ce&&(ce.textContent=ue);var pe=re(Ee),{controller:Ie,applyInitialTheme:$e}=ie({themeToggle:Se,toast:pe}),Ae=Z(pe);if(!de)throw new Error("Screen element not found.");var B=se({screen:de}),{commands:De}=V({profile:D}),R=X({renderer:B,profile:D,fs:z(D),commands:De,theme:Ie,openUrl:Ae}),fe=ee({form:_e,input:U,terminal:R,renderer:B});ae({container:Me,list:Pe,profile:D,aliases:["cv","github","linkedin"],onRunCommand:async e=>{W&&document.activeElement===U&&U.blur(),R.addHistory(e),await R.run(e),B.scrollToBottom(),W||fe.focus()}});$e();R.boot();W||fe.focus();var F=0;window.addEventListener("resize",()=>{F&&cancelAnimationFrame(F),F=requestAnimationFrame(()=>{R.refreshIntroIfPristine(),F=0})});var me=0;document.addEventListener("touchend",e=>{let o=performance.now();e.touches.length>0||(o-me<=300&&e.preventDefault(),me=o)},{passive:!1});
